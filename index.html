<!-- ...same <head> as before... -->
<body>
  <div class="gate" id="gate">
    <div class="card">
      <h2>Enter PIN</h2>

      <form id="pinForm" class="row">
        <input id="pin" inputmode="numeric" placeholder="PIN" />
        <button id="go" type="submit">Enter</button>
      </form>

      <div class="msg" id="msg"></div>
    </div>
  </div>

  <iframe id="frame" style="display:none"
    src="https://storymaps.arcgis.com/stories/54503f443e1e4acc948f8034f505e56d"
    allowfullscreen allow="geolocation"></iframe>

  <script>
    const PIN_HASH_HEX = "03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4"; // 1234

    const gate = document.getElementById("gate");
    const frame = document.getElementById("frame");
    const input = document.getElementById("pin");
    const msg = document.getElementById("msg");
    const form = document.getElementById("pinForm");

    async function sha256Hex(text) {
      const data = new TextEncoder().encode(text);
      const buf = await crypto.subtle.digest("SHA-256", data);
      return [...new Uint8Array(buf)].map(b => b.toString(16).padStart(2, "0")).join("");
    }

    function unlock() {
      gate.style.display = "none";
      frame.style.display = "block";
      frame.style.height = "100vh";
      frame.style.width = "100%";
      frame.style.border = "0";
    }

    async function tryPin() {
      msg.textContent = "";
      const pin = input.value.trim();
      if (!pin) return;

      const hash = await sha256Hex(pin);
      if (hash === PIN_HASH_HEX) {
        sessionStorage.setItem("wedding_unlocked", "1");
        unlock();
      } else {
        msg.textContent = "Wrong PIN. Try again.";
        input.select();
      }
    }

    if (sessionStorage.getItem("wedding_unlocked") === "1") unlock();

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      tryPin();
    });
  </script>
</body>



